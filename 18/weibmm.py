# –ú–µ—Ç–æ–¥ –º–æ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –í–µ–π–±—É–ª–ª–∞
T=227.68662400000002 #—Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ –¥–æ –æ—Ç–∫–∞–∑–∞
D=3393.62612652227 #–¥–∏—Å–ø–µ—Ä—Å–∏—è –Ω–µ—Å–º–µ—â—ë–Ω–Ω–∞—è
print('–†–∞—Å—á—ë—Ç –º–µ—Ç–æ–¥–æ–º –º–æ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –í–µ–π–±—É–ª–ª–∞:')
Ya=(D/T**2)+1
print('Ya =', Ya )
import math #–±–∏–±–ª–∏—Ç–µ–∫–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç
from sympy import * #–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–∏–º–≤–æ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
a = symbols('a')
a1=1+1/a
a2=1+2/a
Q1=1+(1/12)*a1**(-1)+(1/288)*a1**(-2)-(139/51840)*a1**(-3)-(571/2488320)*a1**(-4)
G1=exp(-a1)*a1**(a1-0.5)*((2*math.pi)**0.5)*Q1
Q2=1+(1/12)*a2**(-1)+(1/288)*a2**(-2)-(139/51840)*a2**(-3)-(571/2488320)*a2**(-4)
G2=exp(-a2)*a2**(a2-0.5)*((2*math.pi)**0.5)*Q2
d=G2/(G1**2)
#print('d =',d)
from scipy.optimize import fsolve # –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π
def f(a):
   return Ya-0.398942280401433*(1 + 1/a)**(-1.0 - 2/a)*(1 + 2/a)**(0.5 + 2/a)*(1 + 0.0833333333333333/(1 + 2/a) + 0.00347222222222222/(1 + 2/a)**2 - 0.00268132716049383/(1 + 2/a)**3 - 0.000229472093621399/(1 + 2/a)**4)*math.exp(-1 - 2/a)*math.exp(2 + 2/a)/(1 + 0.0833333333333333/(1 + 1/a) + 0.00347222222222222/(1 + 1/a)**2 - 0.00268132716049383/(1 + 1/a)**3 - 0.000229472093621399/(1 + 1/a)**4)**2
a = fsolve(f, 0.5) #–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è —É—Ä–∞–≤–Ω–µ–Ω–∏—è a0=0.5
a=float(a[0])
print('a=',a)#–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ a
b=T/gamma(1+1/a)
print('b =',b) #–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ b

#–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ Fe(t) –∏ Fw(t)
import matplotlib.pyplot as plt #–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
def func1 (t):
    return (1-exp(-(t/b)**a))
sample=[]
f=open('nn.txt',"r")
for line in f:
    sample+=[float(line.strip('\n').replace(',', '.'))]
sample.sort() #—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
xlist1 = sample
ylist1 = [func1 (x) for x in xlist1]
x2 = []
y2 = []
y1 = 0
for x in sample:
    x2.extend([x,x])
    y2.append(y1)
    y1 += 1.0 / len(sample)
    y2.append(y1)
plt.hlines(y=1, xmin=362.5173, xmax=382, color='m')
plt.title('–ì—Ä–∞—Ñ–∏–∫ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –í–µ–π–±—É–ª–ª–∞')
plt.ylabel('Fe, Fw')
plt.xlabel('t')
plt.grid(which='both')
plt.plot(x2,y2, color='m', label = u'Fe(t)')#–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≥—Ä–∞—Ñ–∏–∫–∞ Fe(t)
plt.plot (xlist1, ylist1,label = u'Fw(t)')#–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≥—Ä–∞—Ñ–∏–∫–∞ Fw(t)
plt.legend ()
plt.show()

#–†–∞—Å—á—ë—Ç œÉ, Sk, Ex –¥–ª—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É—é—â–µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –í–µ–π–±—É–ª–ª–∞
D1=(b**2)*(gamma(1+2/a)-(gamma(1+1/a))**2)
Sko=D1**0.5
Sk=((2*((gamma(1+1/a))**3))-(3*gamma(1+1/a))*(gamma(1+2/a))+(gamma(1+3/a)))/((gamma(1+2/a))-((gamma(1+1/a))**2))**(3/2)
Ex=((gamma(1+4/a)-4*gamma(1+3/a)*gamma(1+1/a)+6*gamma(1+2/a)*(gamma(1+1/a))**2-3*(gamma(1+1/a))**4)/(gamma(1+2/a)-(gamma(1+1/a))**2)**2)-3
print('Sko =', Sko, 'Sk =', Sk, 'Ex =', Ex)

#–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ y(t)
y2y=([y2[i] for i in range(len(y2)-1) if y2[i] != y2[i+1]])
x2y=([x2[i] for i in range(len(x2)-1) if x2[i] != x2[i+1]])
x2y.append(x2[-1])
yx=[]
yy=[]
yabs=0
for i in range(len(sample)):
    yx.append(sample[i])
    yabs=abs(y2y[i]-ylist1[i])
    yy.append(yabs)
plt.title('–ì—Ä–∞—Ñ–∏–∫ y(t)')
plt.ylabel('y')
plt.xlabel('t')
plt.plot(yx,yy, color='g') #–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≥—Ä–∞—Ñ–∏–∫–∞ y(t)
plt.grid(which='both')
plt.show()
D2=max(yy) #–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ D
N=50
l2=D2*N**0.5 #–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ ùúÜ
print('D =',D2, 'l =', l2) #–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ D, ùúÜ
