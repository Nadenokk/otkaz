#–ú–µ—Ç–æ–¥ –º–æ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
T=187.63408999999996 #—Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ –¥–æ –æ—Ç–∫–∞–∑–∞
D=10123.66686227602 #–¥–∏—Å–ø–µ—Ä—Å–∏—è –Ω–µ—Å–º–µ—â—ë–Ω–Ω–∞—è
# –†–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
a=T**2/D
l=T/D
# –†–∞—Å—á—ë—Ç œÉ, Sk, Ex –¥–ª—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É—é—â–µ–≥–æ –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
Sko=(a**0.5)/l
Sk=2/(a**0.5)
Ex=6/a
print('–†–∞—Å—á—ë—Ç –º–µ—Ç–æ–¥–æ–º –º–æ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:')
print('a =', a, 'ùúÜ =', l,'Sko =', Sko,'Sk =', Sk, 'Ex =', Ex)

#–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ F–ì(t) –∏ Fe(t)
from sympy import * #–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å–∏–º–≤–æ–ª—å–Ω–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ sympy
t = symbols('t')
K=(l**a)/gamma(a)
dd=K*(t**(a-1))*exp(-l*t)
ff=integrate(dd,t,manual=True) #–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ F–ì(t)
print('F–ì(t) =', ff,'+ –°' )
C=0.308387311935103*uppergamma(3.47764818904885, 0) #–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
print('–° =', C)
print('F–ì(t) =', ff, '+', C) #–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω F–ì(t)
import matplotlib.pyplot as plt #–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
sample=[]
f=open('nn.txt',"r")
for line in f:
    sample+=[float(line.strip('\n').replace(',', '.'))]
sample.sort() #—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
def func (x):
    return (-0.308387311935103*uppergamma(3.47764818904885, 0.0185342023352412*x)+0.999999999999997)
xlist = sample
ylist = [func (x) for x in xlist]
x2 = []
y2 = []
y1 = 0
for x in sample:
    x2.extend([x,x])
    y2.append(y1)
    y1 += 1.0 / len(sample)
    y2.append(y1)
plt.hlines(y=1, xmin=540.448, xmax=560, color='m')
plt.title('–ì—Ä–∞—Ñ–∏–∫ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è')
plt.ylabel('Fe, F–ì')
plt.xlabel('t')
plt.plot(x2,y2, color='m', label = u'Fe(t)')#–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≥—Ä–∞—Ñ–∏–∫–∞ Fe(t)
plt.grid(which='both')
plt.plot (xlist, ylist, label = u'F–ì(t)')#–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≥—Ä–∞—Ñ–∏–∫–∞ F–ì(t)
plt.legend()
plt.show()

#–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ y(t)
y2y=([y2[i] for i in range(len(y2)-1) if y2[i] != y2[i+1]])
x2y=([x2[i] for i in range(len(x2)-1) if x2[i] != x2[i+1]])
x2y.append(x2[-1])
yx=[]
yy=[]
yabs=0
for i in range(len(sample)):
    yx.append(sample[i])
    yabs=abs(y2y[i]-ylist[i])
    yy.append(yabs)
plt.title('–ì—Ä–∞—Ñ–∏–∫ y(t)')
plt.ylabel('y')
plt.xlabel('t')
plt.plot(yx,yy, color='g')#–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≥—Ä–∞—Ñ–∏–∫–∞ y(t)
plt.grid(which='both')
plt.show()
D1=max(yy) #–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ D
N=50
l1=D1*N**0.5 #–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ ùúÜ
print('D =', D1,'l =', l1) #–≤—ã–≤–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ D, ùúÜ
